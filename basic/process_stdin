#!../c99sh
// Test that stdin is properly passed to the compiled program
#include <stdio.h>
#include <string.h>

int main()
{
    char name[100];
    int age;
    const char *expected_name = "Alice";
    const int expected_age = 30;

    // Read name from stdin
    if (fgets(name, sizeof(name), stdin) == NULL) {
        fprintf(stderr, "Failed to read name from stdin\n");
        return 1;
    }

    // Remove newline if present
    name[strcspn(name, "\n")] = 0;

    // Read age from stdin
    if (scanf("%d", &age) != 1) {
        fprintf(stderr, "Failed to read age from stdin\n");
        return 1;
    }

    // Validate the data read matches expected values
    if (strcmp(name, expected_name) != 0) {
        fprintf(stderr, "Error: Expected name '%s' but got '%s'\n", expected_name, name);
        return 1;
    }

    if (age != expected_age) {
        fprintf(stderr, "Error: Expected age %d but got %d\n", expected_age, age);
        return 1;
    }

    // Output success message
    printf("stdin test passed: Name: %s, Age: %d\n", name, age);
    return 0;
}
// vim:syntax=c
